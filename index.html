
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>풍선 메시지</title>
    <style>
        body {
            background: linear-gradient(to top, #d0eaff, #ffffff);
            overflow: hidden;
            font-family: sans-serif;
            margin: 0;
            padding: 0;
        }
        .balloon {
            position: absolute;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 25px;
            animation-duration: 30s;
            animation-fill-mode: forwards;
            font-size: 1rem;
            color: #333;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 250px;
            word-wrap: break-word;
            text-align: center;
            white-space: normal;
        }
        @keyframes floatUp1 {
            0% { bottom: -60px; transform: translateX(0); opacity: 0; }
            50% { transform: translateX(-10px); opacity: 1; }
            100% { bottom: 100vh; transform: translateX(10px); opacity: 0; }
        }
        @keyframes floatUp2 {
            0% { bottom: -60px; transform: scale(1); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { bottom: 100vh; transform: scale(0.95); opacity: 0; }
        }
        @keyframes floatUp3 {
            0% { bottom: -60px; transform: rotate(0deg); opacity: 0; }
            50% { transform: rotate(2deg); opacity: 1; }
            100% { bottom: 100vh; transform: rotate(-2deg); opacity: 0; }
        }
    </style>
</head>
<body>
<script>
const sheetID = "1FUDbQsDeZBg8Pn7_ngzsk8OgB7fRZiIaIQi4eb-azQs";
const sheetName = "Form Responses 1";
const query = encodeURIComponent("SELECT B, C");
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}&tq=${query}`;

function randomInterval(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function createBalloon(text, offset) {
    const div = document.createElement('div');
    div.className = 'balloon';
    div.style.left = (offset * 15 + 5 + Math.random() * 5) + '%';
    div.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 90%)`;
    const anim = ['floatUp1', 'floatUp2', 'floatUp3'][Math.floor(Math.random() * 3)];
    div.style.animationName = anim;
    div.textContent = text;
    document.body.appendChild(div);
    setTimeout(() => div.remove(), 30000);
}

async function fetchMessages() {
    try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substring(47).slice(0, -2));
        const rows = json.table.rows;
        const count = Math.min(rows.length, 5);
        const indexes = [];
        while (indexes.length < count) {
            const i = Math.floor(Math.random() * rows.length);
            if (!indexes.includes(i)) indexes.push(i);
        }
        indexes.forEach((i, idx) => {
            const message = rows[i].c[0]?.v || "";
            const name = rows[i].c[1]?.v || "";
            if (message) createBalloon(`${message} — ${name}`, idx);
        });
    } catch (err) {
        console.error("불러오기 실패:", err);
    }
}

function loopMessagesRandomly() {
    const delay = randomInterval(5000, 12000);
    fetchMessages().then(() => {
        setTimeout(loopMessagesRandomly, delay);
    });
}

loopMessagesRandomly();
</script>
</body>
</html>
